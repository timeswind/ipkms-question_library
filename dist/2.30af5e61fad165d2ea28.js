webpackJsonp([2],{314:function(e,a,t){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var n=t(5),r=s(n),i=t(7);a.default={data:function(){return{activeTab:"manage-users",searchInputHintText:"姓名或郵箱",newUserDialogShow:!1}},methods:(0,r.default)({handleSearchRoleChange:function(e){"teacher"===e?this.searchInputHintText="姓名或郵箱":this.searchInputHintText="姓名或學號",this.updateSearchOptions({searchRole:e})},handleNewUserMetaChange:function(e,a){var t={};t[e]=a,this.updateNewUserMeta(t)},handleSearchKeyChange:function(e){this.updateSearchOptions({searchKey:e})},handleTabChange:function(e){this.activeTab=e},search:function(){var e=this,a=this.searchKey;if(""!==a){var t;if("teacher"===this.searchRole){var s=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;t=s.test(a)?"/api/manage-account/teachers?email="+a:"/api/manage-account/teachers?name="+a}else"student"===this.searchRole&&(t=isNaN(a)?"/api/manage-account/students?name="+a:"/api/manage-account/students?schoolId="+a);this.$http.get(t).then(function(a){a.data.success&&a.data.users&&(e.updateUsers(a.data.users),e.$showToast("獲取用戶"))})}},createNewUser:function(){var e=this;this.$http.post("/api/manage-account/users",this.newUser).then(function(a){a.data.success&&(e.newUserDialogShow=!1,e.resetNewUserMeta(),e.$showToast("創建用戶成功"))},function(a){e.$showToast("!!"+a.data+"!!")})},toggleNewUserDialog:function(){this.newUserDialogShow=!this.newUserDialogShow},userOnSelect:function(e){this.updateSelectedUser(this.users[e]),this.$router.push({name:"admin-user-detail",params:{id:this.users[e]._id}})}},(0,i.mapActions)({updateSelectedUser:"setAdminPanelUser",updateUsers:"setAdminPanelUsers",updateSearchOptions:"setAdminPanelSearchOptions",updateNewUserMeta:"setAdminPanelNewUserMeta",resetNewUserMeta:"resetAdminPanelNewUserMeta"})),computed:(0,r.default)({},(0,i.mapGetters)({users:"adminPanelUsers",searchKey:"adminPanelSearchKey",searchRole:"adminPanelSearchRole",newUser:"adminPanelNewUser"}))}},315:function(e,a,t){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var n=t(5),r=s(n),i=t(7);a.default={mounted:function(){this.$nextTick(function(){this.$route.params.id&&this.getUserInfo()})},data:function(){return{password:""}},methods:(0,r.default)({getUserInfo:function(){var e=this,a=this.$route.params.id;this.$http.get("/api/manage-account/user/"+a).then(function(a){a.data.success&&a.data.user&&e.updateUser(a.data.user)})},resetPassword:function(){var e=this;if(this.password.length>=6){var a=this.$route.params.id,t={password:this.password};this.$http.post("/api/manage-account/users/reset-password/"+a,t).then(function(a){a.data.success&&e.$showToast("Success")})}else this.$showToast("Length of password should be greater then 6")}},(0,i.mapActions)({updateUser:"setAdminPanelUser"})),computed:(0,r.default)({},(0,i.mapGetters)({user:"adminPanelUserDetail"}))}},386:function(e,a,t){a=e.exports=t(2)(),a.push([e.id,".search-bar[data-v-0172d73b]{border-radius:3px;background:#fff;box-shadow:0 1px 4px rgba(0,0,0,.04);border:1px solid rgba(0,0,0,.09);margin:16px 0;display:inline-block}.search-bar .textfield[data-v-0172d73b]{margin:0 16px}.role-radio[data-v-0172d73b]{margin:0 8px}.new-user-role-radio[data-v-0172d73b]{margin:0 16px 0 0}.form[data-v-0172d73b]{border:1px solid #ddd}.new-user-form[data-v-0172d73b]{border-radius:3px;background:#fff;box-shadow:0 1px 4px rgba(0,0,0,.04);border:1px solid rgba(0,0,0,.09);margin:16px auto;max-width:600px}","",{version:3,sources:["/./src/views/AdminPanel/AdminPanel.vue"],names:[],mappings:"AACA,6BACE,kBAAmB,AACnB,gBAAiB,AACjB,qCAAyC,AACzC,iCAAqC,AACrC,cAAe,AACf,oBAAsB,CACvB,AACD,wCACE,aAAc,CACf,AACD,6BACE,YAAc,CACf,AACD,sCACE,iBAAmB,CACpB,AACD,uBACE,qBAAsB,CACvB,AACD,gCACE,kBAAmB,AACnB,gBAAiB,AACjB,qCAAyC,AACzC,iCAAqC,AACrC,iBAAkB,AAClB,eAAiB,CAClB",file:"AdminPanel.vue",sourcesContent:["\n.search-bar[data-v-0172d73b] {\n  border-radius: 3px;\n  background: #fff;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, .04);\n  border: 1px solid rgba(0, 0, 0, .09);\n  margin: 16px 0;\n  display: inline-block;\n}\n.search-bar .textfield[data-v-0172d73b] {\n  margin: 0 16px\n}\n.role-radio[data-v-0172d73b] {\n  margin: 0 8px;\n}\n.new-user-role-radio[data-v-0172d73b] {\n  margin: 0 16px 0 0;\n}\n.form[data-v-0172d73b] {\n  border: 1px solid #ddd\n}\n.new-user-form[data-v-0172d73b] {\n  border-radius: 3px;\n  background: #fff;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, .04);\n  border: 1px solid rgba(0, 0, 0, .09);\n  margin: 16px auto;\n  max-width: 600px;\n}\n"],sourceRoot:"webpack://"}])},396:function(e,a,t){a=e.exports=t(2)(),a.push([e.id,".user-detail-card[data-v-7d4b507c]{border-radius:3px;background:#fff;box-shadow:0 1px 4px rgba(0,0,0,.04);border:1px solid rgba(0,0,0,.09);max-width:600px;margin:16px auto;padding:16px}","",{version:3,sources:["/./src/views/AdminPanel/UserDetail.vue"],names:[],mappings:"AACA,mCACE,kBAAmB,AACnB,gBAAiB,AACjB,qCAAyC,AACzC,iCAAqC,AAErC,gBAAiB,AACjB,iBAAkB,AAClB,YAAc,CACf",file:"UserDetail.vue",sourcesContent:["\n.user-detail-card[data-v-7d4b507c] {\n  border-radius: 3px;\n  background: #fff;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, .04);\n  border: 1px solid rgba(0, 0, 0, .09);\n  margin: 16px auto;\n  max-width: 600px;\n  margin: 16px auto;\n  padding: 16px;\n}\n"],sourceRoot:"webpack://"}])},402:function(e,a,t){var s=t(386);"string"==typeof s&&(s=[[e.id,s,""]]);t(3)(s,{});s.locals&&(e.exports=s.locals)},415:function(e,a,t){var s=t(396);"string"==typeof s&&(s=[[e.id,s,""]]);t(3)(s,{});s.locals&&(e.exports=s.locals)},498:function(e,a,t){var s,n;t(402),s=t(314);var r=t(513);n=s=s||{},"object"!=typeof s.default&&"function"!=typeof s.default||(n=s=s.default),"function"==typeof n&&(n=n.options),n.render=r.render,n.staticRenderFns=r.staticRenderFns,n._scopeId="data-v-0172d73b",e.exports=s},499:function(e,a,t){var s,n;t(415),s=t(315);var r=t(527);n=s=s||{},"object"!=typeof s.default&&"function"!=typeof s.default||(n=s=s.default),"function"==typeof n&&(n=n.options),n.render=r.render,n.staticRenderFns=r.staticRenderFns,n._scopeId="data-v-7d4b507c",e.exports=s},513:function(e,a){e.exports={render:function(){var e=this;return e._h("div",[e._h("mu-tabs",{attrs:{value:e.activeTab},on:{change:e.handleTabChange}},[e._h("mu-tab",{attrs:{value:"manage-users",title:"管理用戶"}})])," ","manage-users"===e.activeTab?e._h("div",[e._h("mu-dialog",{attrs:{open:e.newUserDialogShow,title:"創建新用戶"},on:{close:e.toggleNewUserDialog}},[e._h("div",{staticClass:"flex-row",staticStyle:{"margin-bottom":"16px"}},[e._h("mu-radio",{staticClass:"new-user-role-radio",attrs:{label:"學生",name:"newUserRole",nativeValue:"student",value:e.newUser.role},on:{change:function(a){e.handleNewUserMetaChange("role",a)}}})," ",e._h("mu-radio",{staticClass:"new-user-role-radio",attrs:{label:"教師",name:"newUserRole",nativeValue:"teacher",value:e.newUser.role},on:{change:function(a){e.handleNewUserMetaChange("role",a)}}})])," ","teacher"===e.newUser.role?e._h("div",[e._h("mu-text-field",{attrs:{label:"郵箱",labelFloat:"",value:e.newUser.email},on:{change:function(a){e.handleNewUserMetaChange("email",a)}}})]):e._h("div",[e._h("mu-text-field",{attrs:{label:"學號",labelFloat:"",value:e.newUser.schoolId},on:{change:function(a){e.handleNewUserMetaChange("schoolId",a)}}})])," "," ",e._h("div",[e._h("mu-text-field",{attrs:{label:"姓名",labelFloat:"",value:e.newUser.name},on:{change:function(a){e.handleNewUserMetaChange("name",a)}}})])," ",e._h("div",[e._h("mu-text-field",{attrs:{label:"初始密碼",labelFloat:"",type:"password",value:e.newUser.password},on:{change:function(a){e.handleNewUserMetaChange("password",a)}}})])," ",e._h("mu-flat-button",{attrs:{label:"取消"},on:{click:e.toggleNewUserDialog},slot:"actions"})," ",e._h("mu-raised-button",{attrs:{primary:"",label:"創建"},on:{click:e.createNewUser},slot:"actions"})])," ",e._h("div",{staticClass:"flex-row flex-center",staticStyle:{margin:"0 16px 0 16px"}},[e._h("div",{staticClass:"search-bar"},[e._h("div",{staticClass:"flex-row flex-center"},[e._h("div",{staticClass:"flex-row",staticStyle:{"margin-left":"8px"}},[e._h("mu-radio",{staticClass:"role-radio",attrs:{label:"學生",name:"searchKey",nativeValue:"student",value:e.searchRole},on:{change:e.handleSearchRoleChange}})," ",e._h("mu-radio",{staticClass:"role-radio",attrs:{label:"教師",name:"searchKey",nativeValue:"teacher",value:e.searchRole},on:{change:e.handleSearchRoleChange}})])," ",e._h("div",{staticClass:"flex-row flex-center"},[e._h("mu-text-field",{staticClass:"textfield",attrs:{hintText:e.searchInputHintText,value:e.searchKey},on:{input:e.handleSearchKeyChange}})," ",e._h("mu-raised-button",{staticStyle:{"margin-left":"auto","margin-right":"16px"},attrs:{primary:"",label:"搜索"},on:{click:function(a){e.search()}}})])])])," ",e._h("mu-raised-button",{staticStyle:{"margin-left":"auto"},attrs:{primary:"",label:"創建新用戶"},on:{click:e.toggleNewUserDialog}})])," ",e._h("mu-table",{staticClass:"form",attrs:{showCheckbox:!1}},[e._h("mu-thead",[e._h("mu-tr",[e._h("mu-th",["#"])," ",e._h("mu-th",["Name"])," ",e._h("mu-th",["Role"])," ","teacher"===e.searchRole?e._h("mu-th",["Email"]):e._e()," ","student"===e.searchRole?e._h("mu-th",["School Id"]):e._e()])])," ",e._h("mu-tbody",[e._l(e.users,function(a,t){return e._h("mu-tr",{key:a._id,staticStyle:{cursor:"pointer"},nativeOn:{click:function(a){e.userOnSelect(t)}}},[e._h("mu-td",[e._s(t+1)])," ",e._h("mu-td",[e._s(a.name)])," ",e._h("mu-td",[e._s(a.role)])," ","teacher"===e.searchRole?e._h("mu-td",[e._s(a.email)]):e._e()," ","student"===e.searchRole?e._h("mu-td",[e._s(a.schoolId)]):e._e()])})])])]):e._e()])},staticRenderFns:[]}},527:function(e,a){e.exports={render:function(){var e=this;return e._h("div",{staticClass:"user-detail-card"},[e._h("div",{staticClass:"flex-column"},[e._h("span",{staticClass:"field-title"},["姓名"])," ",e._h("span",{staticClass:"field-content"},[e._s(e.user.name)])])," ",e._h("div",{staticClass:"flex-column"},[e._h("span",{staticClass:"field-title"},["Role"])," ",e._h("span",{staticClass:"field-content"},[e._s(e.user.role)])])," ","teacher"===e.user.role?e._h("div",{staticClass:"flex-column"},[e._h("span",{staticClass:"field-title"},["郵箱"])," ",e._h("span",{staticClass:"field-content"},[e._s(e.user.email)])]):e._e()," ","student"===e.user.role?e._h("div",{staticClass:"flex-column"},[e._h("span",{staticClass:"field-title"},["學號"])," ",e._h("span",{staticClass:"field-content"},[e._s(e.user.schoolId)])]):e._e()," ",e._h("div",{staticClass:"flex-row flex-center"},[e._h("mu-text-field",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{label:"重置密碼",labelFloat:"",type:"password"},domProps:{value:e.password},on:{input:function(a){e.password=a}}})," ",e._h("mu-raised-button",{staticStyle:{margin:"0 16px"},attrs:{primary:"",label:"重置密碼"},on:{click:e.resetPassword}})])])},staticRenderFns:[]}}});
//# sourceMappingURL=2.30af5e61fad165d2ea28.js.map